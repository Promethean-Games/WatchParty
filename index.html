<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Watch Party</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#020617" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="app">
    <header class="app-header">
      <div class="header-left">
        <img
          src="https://prometheangamescom.wordpress.com/wp-content/uploads/2025/12/logo-1.png"
          alt="Promethean Games logo"
          class="app-logo"
        />
        <div class="logo-text">
          <h1>Watch Party</h1>
          <p>Race to react, brag all night.</p>
          <p id="roomCodeHeader" class="room-code-text subtle"></p>
        </div>
      </div>
      <button id="settingsBtn" class="settings-btn" aria-label="Settings">‚öô</button>
    </header>

    <main class="app-main">
      <!-- Screen: Setup / Players -->
      <section id="screen-setup" class="screen active">
        <div class="card">
          <h2>Your crew</h2>

          <label class="field">
            <span class="field-label">Host name</span>
            <input id="hostNameInput" type="text" maxlength="24" placeholder="e.g. Ace" />
          </label>

          <label class="field">
            <div class="field-label-row">
              <span class="field-label">Room code</span>
              <span class="field-hint">
                Choose a room code and tap Connect so everyone joins the same game.
              </span>
            </div>
            <div class="player-input-row">
              <input id="roomCodeInput" type="text" maxlength="8" placeholder="e.g. 4FG9" />
              <button id="roomConnectBtn" class="btn btn-ghost small">Connect</button>
            </div>
          </label>

          <div class="field">
            <div class="field-label-row">
              <span class="field-label">Players</span>
              <span class="subtle">Local hotseat: everyone can share this device.</span>
            </div>
            <div class="player-input-row">
              <input id="playerNameInput" type="text" maxlength="18" placeholder="Add player name" />
              <select id="playerAvatarSelect">
                <option>üéÆ</option>
                <option>üçø</option>
                <option>üèà</option>
                <option>üé¨</option>
                <option>üòÇ</option>
                <option>üî•</option>
              </select>
              <button id="addPlayerBtn" class="btn btn-primary">Add</button>
            </div>
            <div id="playersList" class="chips-row"></div>
          </div>

          <div class="tip-row">
            <span class="tip-icon" tabindex="0">?</span>
            <span class="tip-text">
              Tip: in multi-device mode, each phone is its own player. On a single phone, tap your name before tapping an event so points go to the right person.
            </span>
          </div>

          <button id="toListsBtn" class="btn btn-cta">Save &amp; pick a list</button>
        </div>
      </section>

      <!-- Screen: Lists -->
      <section id="screen-lists" class="screen">
        <div class="screen-header">
          <button class="btn btn-ghost" id="listsBackBtn">&larr; Crew</button>
          <div class="screen-title">
            <h2>Lists &amp; broadcasts</h2>
            <p id="profileSummary">No profile yet</p>
          </div>
        </div>

        <div class="card">
          <h3>Sample lists</h3>
          <p class="subtle">Quick start for movies, sports, and shows.</p>
          <div id="sampleLists" class="list-cards"></div>
        </div>

        <div class="card">
          <h3>Your custom lists</h3>
          <p class="subtle">Saved to this device for future watch nights.</p>
          <div id="customLists" class="list-cards empty-state">
            <p class="subtle">No custom lists yet. Create one below.</p>
          </div>
        </div>

        <div class="card">
          <h3>Create a new list</h3>
          <label class="field">
            <span class="field-label">List name</span>
            <input id="listNameInput" type="text" maxlength="40" placeholder="e.g. Sunday Night Football" />
          </label>
          <label class="field">
            <span class="field-label">Category</span>
            <select id="listCategorySelect">
              <option value="Movie">Movie</option>
              <option value="Sports">Sports</option>
              <option value="Series">TV series</option>
              <option value="Other">Other</option>
            </select>
          </label>
          <label class="field">
            <span class="field-label">
              Events (one per line)
            </span>
            <textarea id="listEventsInput" rows="5" placeholder="Field goal blocked
Awkward silence
Someone yells at the ref"></textarea>
          </label>
          <div class="tip-row">
            <span class="tip-icon" tabindex="0">?</span>
            <span class="tip-text">
              Gesture tip: tap an event when it happens on screen. We‚Äôll handle the points and vetoes.
            </span>
          </div>
          <button id="saveListBtn" class="btn btn-primary">Save list</button>
        </div>
      </section>

      <!-- Screen: Game -->
      <section id="screen-game" class="screen">
        <div class="screen-header">
          <button class="btn btn-ghost" id="gameBackToListsBtn">&larr; Lists</button>
          <div class="screen-title">
            <h2 id="nowPlayingTitle">No list loaded</h2>
            <p id="nowPlayingMeta" class="subtle"></p>
          </div>
        </div>

        <div class="card card-compact">
          <div class="players-bar">
            <div class="players-bar-top">
              <span class="field-label">Who‚Äôs tapping?</span>
              <button id="resetScoresBtn" class="btn btn-ghost small">Reset scores</button>
            </div>
            <div id="playersChips" class="chips-row compact"></div>
          </div>
        </div>

        <div class="card card-compact">
          <div class="search-row">
            <input id="eventSearchInput" type="search" placeholder="Search events (e.g. 'touchdown')" />
          </div>
          <div class="tip-row small">
            <span class="tip-icon" tabindex="0">?</span>
            <span class="tip-text">
              Tap an event to claim it. We lock it briefly so nobody can spam it.
            </span>
          </div>
        </div>

        <div class="card game-layout">
          <div class="events-column">
            <h3>Event list</h3>
            <div id="eventsList" class="events-grid"></div>
          </div>
          <div class="feed-column">
            <div class="feed-header">
              <h3>Live feed</h3>
              <button id="vetoBtn" class="btn btn-warning small">
                Veto last tap
              </button>
            </div>
            <ul id="feedList" class="feed-list"></ul>
          </div>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <span id="versionFooter"></span>
    </footer>

    <!-- Tutorial overlay -->
    <div id="tutorialOverlay" class="overlay">
      <div class="overlay-card tutorial-card">
        <h3>How Watch Party works</h3>
        <div id="tutorialSlidesWrapper" class="tutorial-slides-wrapper">
          <div class="tutorial-slides">
            <div class="tutorial-slide active">
              <h4>1. Pick a room & crew</h4>
              <p>
                Choose a room code, tap <strong>Connect</strong>, and share the code so friends can join from their own phones.
              </p>
              <p class="tutorial-note">Swipe left or tap Next to continue.</p>
            </div>
            <div class="tutorial-slide">
              <h4>2. Load a list</h4>
              <p>
                Pick a preset list for live sports, TV, movies, or family chaos ‚Äì or create your own events for any watch night.
              </p>
              <p class="tutorial-note">Everyone in the same room shares the same scoreboard.</p>
            </div>
            <div class="tutorial-slide">
              <h4>3. Race to react</h4>
              <p>
                When an event happens on screen, tap it first to score. Anyone can <strong>veto</strong> the last tap if it was a false alarm.
              </p>
              <p class="tutorial-note">You can always re-open this tutorial from Settings.</p>
            </div>
          </div>
        </div>
        <div class="tutorial-dots">
          <button class="tutorial-dot active" data-index="0"></button>
          <button class="tutorial-dot" data-index="1"></button>
          <button class="tutorial-dot" data-index="2"></button>
        </div>
        <div class="tutorial-actions">
          <button id="tutorialSkipBtn" class="btn btn-ghost small">Skip</button>
          <div class="tutorial-nav">
            <button id="tutorialPrevBtn" class="btn btn-ghost small">‚Äπ</button>
            <button id="tutorialNextBtn" class="btn btn-primary small">Next</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Settings overlay -->
    <div id="settingsOverlay" class="overlay">
      <div class="overlay-card settings-card">
        <div class="settings-header">
          <h3>Settings</h3>
          <button id="settingsCloseBtn" class="btn-icon" aria-label="Close settings">‚úï</button>
        </div>
        <div class="settings-body">
          <button id="settingsTutorialBtn" class="btn btn-ghost full-width">
            View tutorial
          </button>

          <label class="field settings-field">
            <span class="field-label">Theme</span>
            <select id="settingsThemeSelect">
              <option value="dark">Dark</option>
              <option value="light">Light</option>
            </select>
          </label>

          <label class="field settings-field">
            <span class="field-label">Right-handed mode</span>
            <div class="field-inline">
              <input type="checkbox" id="settingsHandToggle" />
              <span class="subtle">Events on right, log on left</span>
            </div>
          </label>

          <label class="field settings-field">
            <span class="field-label">Reduce motion</span>
            <div class="field-inline">
              <input type="checkbox" id="settingsMotionToggle" />
              <span class="subtle">Minimize animations and transitions</span>
            </div>
          </label>
        </div>
      </div>
    </div>

    <div id="toast" class="toast"></div>
  </div>

  <!-- Firebase SDKs (must be before app.js) -->
  <script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-database-compat.js"></script>
  <script src="firebase-config.js"></script>

  <script src="app.js"></script>
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", function () {
        navigator.serviceWorker
          .register("service-worker.js")
          .catch(function () {});
      });
    }
  </script>
</body>
</html>
